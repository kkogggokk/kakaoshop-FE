"use strict";(self.webpackChunkkakao_shop_clone=self.webpackChunkkakao_shop_clone||[]).push([[449],{1449:(e,t,s)=>{s.r(t),s.d(t,{default:()=>j});var a=s(5043),r=s(4231),i=s(9696),n=s(9397),o=s(5475),c=s(3838),l=s(2251),d=s(579);const u={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_PATH:"http://localhost",REACT_APP_API_COUPON_URL:"http://localhost:8080"}.REACT_APP_PATH||"",m=e=>{let{item:t,onChange:s}=e;const[m,p]=(0,a.useState)(t.carts.map((e=>({id:e.id,amount:e.price})))),[x,h]=(0,a.useState)(t.carts.reduce(((e,t)=>e+t.price),0)),b=(0,a.useCallback)((e=>{const t=m.find((t=>t.id===e));return t?t.amount:0}),[m]),_=(0,a.useCallback)(((e,t)=>{p((s=>s.map((s=>s.id===e?{...s,amount:s.amount+t}:s)))),h((e=>e+t))}),[]);return(0,d.jsxs)(r.A,{className:"border rounded bg-white px-10 py-6 my-2",children:[(0,d.jsxs)("div",{className:"flex items-center  mb-3",children:[(0,d.jsx)(l.A,{className:"w-20 h-20 rounded border border-neutral-200",src:`http://localhost/images/${t.id}.jpg`,alt:`${t.productName} image`}),(0,d.jsx)(o.N_,{to:u+`/product/${t.id}`,children:(0,d.jsx)("h5",{className:"pl-3 font-semibold text-base tracking-tighter",children:t.productName})})]}),t.carts.map((e=>0!==e.quantity&&(0,d.jsxs)("div",{className:"border rounded bg-[#FDFDFD] p-6 my-2",children:[(0,d.jsx)("div",{className:"mb-4",children:(0,d.jsx)("span",{children:e.option.optionName})}),(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(c.A,{className:"w-fit h-8 mr-3 bg-white border rounded border-neutral-200 ",onClick:()=>{s(e.id,0,-e.quantity*e.option.price),_(e.id,-e.quantity*e.option.price)},children:(0,d.jsx)("span",{className:"text-sm px-3",children:"\uc0ad\uc81c"})}),(0,d.jsx)(i.A,{value:e.quantity,onIncrease:t=>{s(e.id,t,e.option.price),_(e.id,e.option.price)},onDecrease:t=>{s(e.id,t,-e.option.price),_(e.id,-e.option.price)}}),(0,d.jsxs)("span",{className:"ml-auto",children:[(0,n.c)(b(e.id)),"\uc6d0"]})]})]},e.id))),(0,d.jsxs)("div",{className:"border rounded bg-[#FAFAFA] px-6 py-4 mt-6",children:[(0,d.jsx)("span",{className:"font-semibold",children:"\uc8fc\ubb38\uae08\uc561"}),(0,d.jsxs)("span",{className:"float-right font-semibold",children:[(0,n.c)(x),"\uc6d0"]})]})]})};var p=s(3216),x=s(2907),h=s(7037),b=s(1038),_=s(4552);const N={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_PATH:"http://localhost",REACT_APP_API_COUPON_URL:"http://localhost:8080"}.REACT_APP_PATH||"",j=e=>{let{data:t,isLoading:s}=e;const i=(0,p.Zp)(),[o,l]=(0,a.useState)([]),[u,j]=(0,a.useState)(0),[A,v]=(0,a.useState)(!1),f=(0,a.useRef)([]),{mutate:P}=(0,x.useMutation)({mutationFn:b.iH}),g=(0,a.useCallback)((()=>{let e=0;return o.forEach((t=>{t.carts.forEach((t=>{e+=t.quantity}))})),(0,n.c)(e)}),[o]),C=(0,a.useCallback)((()=>o.every((e=>e.carts.every((e=>0===e.quantity))))),[o]);(0,a.useEffect)((()=>{var e,s,a,r;void 0!==(null===t||void 0===t||null===(e=t.data)||void 0===e||null===(s=e.response)||void 0===s?void 0:s.products)&&l(t.data.response.products),void 0!==(null===t||void 0===t||null===(a=t.data)||void 0===a||null===(r=a.response)||void 0===r?void 0:r.totalPrice)&&j(t.data.response.totalPrice),v(C())}),[t,C]),(0,a.useEffect)((()=>{v(C())}),[o,C]);const y=(e,t,s)=>{const a=f.current,r=a.find((t=>t.cartId===e));f.current=r?[...a.filter((t=>t.cartId!==e)),{cartId:e,quantity:t}]:[...a,{cartId:e,quantity:t}],P(f.current,{onSuccess:a=>{j((e=>e+s)),l((s=>s.map((s=>({...s,carts:s.carts.map((s=>s.id===e?{...s,quantity:t}:s))})))))},onError:e=>{alert(e.message)}})};return(0,d.jsx)("main",{className:"pt-2 pb-10 bg-[#F4F4F4] bg-opacity-70",children:(0,d.jsxs)(h.A,{className:"w-[870px] mx-auto",children:[(0,d.jsx)(r.A,{className:"h-12 border rounded bg-white text-center",children:(0,d.jsx)("h1",{className:"font-semibold text-[15px] mt-3",children:"\uc7a5\ubc14\uad6c\ub2c8"})}),A?(0,d.jsxs)("div",{className:"text-center pt-52 pb-80 mt-2 border rounded bg-white ",children:[(0,d.jsx)(_.gZn,{className:"mx-auto my-4 text-5xl text-neutral-300"}),(0,d.jsx)("span",{className:"text-xl",children:"\uc7a5\ubc14\uad6c\ub2c8\uc5d0 \ub2f4\uae34 \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}),(0,d.jsxs)("div",{className:"flex w-fit mx-auto my-4",children:[(0,d.jsx)("button",{className:"w-[100px] mx-1 px-3 py-2 rounded border border-neutral-300 bg-white",onClick:()=>i(-1),children:(0,d.jsx)("span",{className:"text-sm text-black",children:"\uc774\uc804\ud654\uba74"})}),(0,d.jsx)("button",{className:"w-[100px] mx-1 px-3 py-2 rounded bg-black",onClick:()=>i(N+"/"),children:(0,d.jsx)("span",{className:"text-sm text-white",children:"\uc1fc\ud551\ud558\uae30 \ud648"})})]})]}):(0,d.jsxs)("div",{children:[Array.isArray(o)&&o.map((e=>!0!==e.carts.every((e=>0===e.quantity))&&(0,d.jsx)(m,{item:e,onChange:y},e.id))),(0,d.jsxs)("div",{className:"h-fit border rounded bg-white mt-8 px-8 py-6",children:[(0,d.jsx)("span",{className:"font-bold text-lg",children:"\uc8fc\ubb38 \uc608\uc0c1\uae08\uc561"}),(0,d.jsxs)("div",{className:"float-right text-lg font-semibold text-blue-500 pr-4",children:[(0,n.c)(u),"\uc6d0"]})]}),(0,d.jsx)(c.A,{className:"h-fit w-full border rounded bg-[#feeb00] mt-4 p-4 hover:bg-yellow-300",onClick:()=>i(N+"/order"),children:(0,d.jsxs)("span",{className:"font-semibold text-lg",children:[g(),"\uac74 \uc8fc\ubb38\ud558\uae30"]})})]})]})})}}}]);
//# sourceMappingURL=449.152a0d8c.chunk.js.map