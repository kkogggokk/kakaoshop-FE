"use strict";(self.webpackChunkkakao_shop_clone=self.webpackChunkkakao_shop_clone||[]).push([[449],{1449:(e,a,t)=>{t.r(a),t.d(a,{default:()=>f});var s=t(5043),r=t(4231),n=t(9696),c=t(9397),o=t(5475),d=t(3838),i=t(2251),l=t(579);const p={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_PATH:"http://k8s-default-shopback-c8447eb4cd-128335560.ap-northeast-2.elb.amazonaws.com",REACT_APP_API_COUPON_URL:"http://k8s-default-couponap-acba0908a2-1422117942.ap-northeast-2.elb.amazonaws.com"}.REACT_APP_PATH||"",m=e=>{let{item:a,onChange:t}=e;const[m,u]=(0,s.useState)(a.carts.map((e=>({id:e.id,amount:e.price})))),[h,x]=(0,s.useState)(a.carts.reduce(((e,a)=>e+a.price),0)),b=(0,s.useCallback)((e=>{const a=m.find((a=>a.id===e));return a?a.amount:0}),[m]),_=(0,s.useCallback)(((e,a)=>{u((t=>t.map((t=>t.id===e?{...t,amount:t.amount+a}:t)))),x((e=>e+a))}),[]);return(0,l.jsxs)(r.A,{className:"border rounded bg-white px-10 py-6 my-2",children:[(0,l.jsxs)("div",{className:"flex items-center  mb-3",children:[(0,l.jsx)(i.A,{className:"w-20 h-20 rounded border border-neutral-200",src:`http://k8s-default-shopback-c8447eb4cd-128335560.ap-northeast-2.elb.amazonaws.com/images/${a.id}.jpg`,alt:`${a.productName} image`}),(0,l.jsx)(o.N_,{to:p+`/product/${a.id}`,children:(0,l.jsx)("h5",{className:"pl-3 font-semibold text-base tracking-tighter",children:a.productName})})]}),a.carts.map((e=>0!==e.quantity&&(0,l.jsxs)("div",{className:"border rounded bg-[#FDFDFD] p-6 my-2",children:[(0,l.jsx)("div",{className:"mb-4",children:(0,l.jsx)("span",{children:e.option.optionName})}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(d.A,{className:"w-fit h-8 mr-3 bg-white border rounded border-neutral-200 ",onClick:()=>{t(e.id,0,-e.quantity*e.option.price),_(e.id,-e.quantity*e.option.price)},children:(0,l.jsx)("span",{className:"text-sm px-3",children:"\uc0ad\uc81c"})}),(0,l.jsx)(n.A,{value:e.quantity,onIncrease:a=>{t(e.id,a,e.option.price),_(e.id,e.option.price)},onDecrease:a=>{t(e.id,a,-e.option.price),_(e.id,-e.option.price)}}),(0,l.jsxs)("span",{className:"ml-auto",children:[(0,c.c)(b(e.id)),"\uc6d0"]})]})]},e.id))),(0,l.jsxs)("div",{className:"border rounded bg-[#FAFAFA] px-6 py-4 mt-6",children:[(0,l.jsx)("span",{className:"font-semibold",children:"\uc8fc\ubb38\uae08\uc561"}),(0,l.jsxs)("span",{className:"float-right font-semibold",children:[(0,c.c)(h),"\uc6d0"]})]})]})};var u=t(3216),h=t(2907),x=t(7037),b=t(1038),_=t(4552);const N={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_PATH:"http://k8s-default-shopback-c8447eb4cd-128335560.ap-northeast-2.elb.amazonaws.com",REACT_APP_API_COUPON_URL:"http://k8s-default-couponap-acba0908a2-1422117942.ap-northeast-2.elb.amazonaws.com"}.REACT_APP_PATH||"",f=e=>{let{data:a,isLoading:t}=e;const n=(0,u.Zp)(),[o,i]=(0,s.useState)([]),[p,f]=(0,s.useState)(0),[j,A]=(0,s.useState)(!1),v=(0,s.useRef)([]),{mutate:P}=(0,h.useMutation)({mutationFn:b.iH}),g=(0,s.useCallback)((()=>{let e=0;return o.forEach((a=>{a.carts.forEach((a=>{e+=a.quantity}))})),(0,c.c)(e)}),[o]),C=(0,s.useCallback)((()=>o.every((e=>e.carts.every((e=>0===e.quantity))))),[o]);(0,s.useEffect)((()=>{var e,t,s,r;void 0!==(null===a||void 0===a||null===(e=a.data)||void 0===e||null===(t=e.response)||void 0===t?void 0:t.products)&&i(a.data.response.products),void 0!==(null===a||void 0===a||null===(s=a.data)||void 0===s||null===(r=s.response)||void 0===r?void 0:r.totalPrice)&&f(a.data.response.totalPrice),A(C())}),[a,C]),(0,s.useEffect)((()=>{A(C())}),[o,C]);const k=(e,a,t)=>{const s=v.current,r=s.find((a=>a.cartId===e));v.current=r?[...s.filter((a=>a.cartId!==e)),{cartId:e,quantity:a}]:[...s,{cartId:e,quantity:a}],P(v.current,{onSuccess:s=>{f((e=>e+t)),i((t=>t.map((t=>({...t,carts:t.carts.map((t=>t.id===e?{...t,quantity:a}:t))})))))},onError:e=>{alert(e.message)}})};return(0,l.jsx)("main",{className:"pt-2 pb-10 bg-[#F4F4F4] bg-opacity-70",children:(0,l.jsxs)(x.A,{className:"w-[870px] mx-auto",children:[(0,l.jsx)(r.A,{className:"h-12 border rounded bg-white text-center",children:(0,l.jsx)("h1",{className:"font-semibold text-[15px] mt-3",children:"\uc7a5\ubc14\uad6c\ub2c8"})}),j?(0,l.jsxs)("div",{className:"text-center pt-52 pb-80 mt-2 border rounded bg-white ",children:[(0,l.jsx)(_.gZn,{className:"mx-auto my-4 text-5xl text-neutral-300"}),(0,l.jsx)("span",{className:"text-xl",children:"\uc7a5\ubc14\uad6c\ub2c8\uc5d0 \ub2f4\uae34 \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}),(0,l.jsxs)("div",{className:"flex w-fit mx-auto my-4",children:[(0,l.jsx)("button",{className:"w-[100px] mx-1 px-3 py-2 rounded border border-neutral-300 bg-white",onClick:()=>n(-1),children:(0,l.jsx)("span",{className:"text-sm text-black",children:"\uc774\uc804\ud654\uba74"})}),(0,l.jsx)("button",{className:"w-[100px] mx-1 px-3 py-2 rounded bg-black",onClick:()=>n(N+"/"),children:(0,l.jsx)("span",{className:"text-sm text-white",children:"\uc1fc\ud551\ud558\uae30 \ud648"})})]})]}):(0,l.jsxs)("div",{children:[Array.isArray(o)&&o.map((e=>!0!==e.carts.every((e=>0===e.quantity))&&(0,l.jsx)(m,{item:e,onChange:k},e.id))),(0,l.jsxs)("div",{className:"h-fit border rounded bg-white mt-8 px-8 py-6",children:[(0,l.jsx)("span",{className:"font-bold text-lg",children:"\uc8fc\ubb38 \uc608\uc0c1\uae08\uc561"}),(0,l.jsxs)("div",{className:"float-right text-lg font-semibold text-blue-500 pr-4",children:[(0,c.c)(p),"\uc6d0"]})]}),(0,l.jsx)(d.A,{className:"h-fit w-full border rounded bg-[#feeb00] mt-4 p-4 hover:bg-yellow-300",onClick:()=>n(N+"/order"),children:(0,l.jsxs)("span",{className:"font-semibold text-lg",children:[g(),"\uac74 \uc8fc\ubb38\ud558\uae30"]})})]})]})})}}}]);
//# sourceMappingURL=449.3320c898.chunk.js.map